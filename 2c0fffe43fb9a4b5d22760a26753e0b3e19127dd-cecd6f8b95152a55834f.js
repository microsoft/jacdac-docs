"use strict";
(self["webpackChunkjacdac_docs"] = self["webpackChunkjacdac_docs"] || []).push([[591],{

/***/ 32098:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Di": function() { return /* binding */ DEVICE_TEST_KIND; },
/* harmony export */   "bY": function() { return /* binding */ SERVICE_TEST_KIND; },
/* harmony export */   "U": function() { return /* binding */ REGISTER_ORACLE_KIND; },
/* harmony export */   "kB": function() { return /* binding */ PanelTest; },
/* harmony export */   "fn": function() { return /* binding */ DeviceTest; },
/* harmony export */   "RG": function() { return /* binding */ DeviceStatsTest; },
/* harmony export */   "Pv": function() { return /* binding */ StatusLightTest; },
/* harmony export */   "i1": function() { return /* binding */ ServiceTest; },
/* harmony export */   "GT": function() { return /* binding */ ServiceCommandTest; },
/* harmony export */   "j0": function() { return /* binding */ RegisterOracle; },
/* harmony export */   "O7": function() { return /* binding */ RegisterTest; },
/* harmony export */   "CK": function() { return /* binding */ EventTest; }
/* harmony export */ });
/* unused harmony exports PANEL_TEST_KIND, DEVICE_STATS_TEST_KIND, STATUS_LIGHT_TEST_KIND, SERVICE_COMMAND_TEST_KIND, REGISTER_TEST_KIND, EVENT_TEST_KIND, TestNode, ServiceMemberTestNode, RegisterTestNode */
/* harmony import */ var _babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(15861);
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(15785);
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(43144);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(94578);
/* harmony import */ var _jdom_constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(3964);
/* harmony import */ var _jdom_eventsource__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(53304);
/* harmony import */ var _jdom_node__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(40392);
/* harmony import */ var _jdom_random__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(35246);
/* harmony import */ var _jdom_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(46196);
/* harmony import */ var _spec__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(40914);
var PANEL_TEST_KIND="panelTest";var DEVICE_TEST_KIND="deviceTest";var DEVICE_STATS_TEST_KIND="deviceStatsTestKind";var STATUS_LIGHT_TEST_KIND="statusLightTestKind";var SERVICE_TEST_KIND="serviceTest";var SERVICE_COMMAND_TEST_KIND="serviceCommandTest";var REGISTER_TEST_KIND="registerTest";var EVENT_TEST_KIND="eventTest";var REGISTER_ORACLE_KIND="registerOracle";var DEVICE_STATS_MAX_RESTARTS=2;var DEVICE_STATS_MAX_DROPPED_PACKETS=4;var DEVICE_STATS_MIN_ANNOUNCE_PACKETS=2;var TestNode=/*#__PURE__*/function(_JDNode){(0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(TestNode,_JDNode);function TestNode(_name,_manualSteps){var _this;if(_manualSteps===void 0){_manualSteps=undefined;}_this=_JDNode.call(this)||this;_this._id=(0,_jdom_random__WEBPACK_IMPORTED_MODULE_3__/* .randomDeviceId */ .b_)();_this._state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Indeterminate */ .t.Indeterminate;_this._uploadState=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestUploadState.Local */ .k.Local;_this._node=undefined;_this._children=[];_this.subscriptions=new _jdom_eventsource__WEBPACK_IMPORTED_MODULE_1__/* .JDSubscriptionScope */ .f5();_this._name=_name;_this._manualSteps=_manualSteps;return _this;}var _proto=TestNode.prototype;_proto.handleChange=function handleChange(){this.bindChildren();this.updateState();};_proto.bindChildren=function bindChildren(){if(this.node)this._children.forEach(c=>c.bind());else this._children.forEach(c=>c.node=undefined);};_proto.updateState=function updateState(){var{prepare}=this.manualSteps||{};if(prepare&&!this.factory&&(this.state==_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Indeterminate */ .t.Indeterminate||this.state==_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Fail */ .t.Fail))return;// compute local state
var{state,output}=this.nodeState();if(output!==undefined)this.output=output;if(this.children.length===0||state===_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Fail */ .t.Fail)this.state=state;// compute child states
else this.state=this.computeChildrenState();};_proto.prepared=function prepared(){this.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running;this.updateState();if(this.state!=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass)this.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Fail */ .t.Fail;};_proto.resolveOracle=function resolveOracle(reg){var _this$children,_this$parent;return((_this$children=this.children)===null||_this$children===void 0?void 0:_this$children.filter(c=>c.nodeKind===REGISTER_ORACLE_KIND).map(c=>c).filter(c=>!!c.register).find(o=>o.serviceClass===reg.service.serviceClass&&o.code===reg.code))||((_this$parent=this.parent)===null||_this$parent===void 0?void 0:_this$parent.resolveOracle(reg));};_proto.nodeState=function nodeState(){return{state:this.node?_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running:_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Indeterminate */ .t.Indeterminate};};_proto.mount=function mount(){this.subscriptions.mount(this.node.subscribe(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .CHANGE */ .Ver,this.handleChange.bind(this)));};_proto.unmount=function unmount(){this.subscriptions.unmount();this._children.forEach(c=>c.unmount());};_proto.appendChild=function appendChild(child){if(child&&this._children.indexOf(child)<0){this._children.push(child);child.parent=this;if(this.node)child.bind();else child.node=undefined;this.emit(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .CHANGE */ .Ver);this.updateState();}};_proto.bind=function bind(){};_proto.computeChildrenState=function computeChildrenState(){return this._children.reduce((s,c)=>Math.max(s,c.state),_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass);};_proto.toString=function toString(){return this.qualifiedName;};_proto.export=function _export(){var _TestState$this$state;var children=this.children.map(child=>child.export());// eslint-disable-next-line @typescript-eslint/no-explicit-any
var res=Object.assign({id:this.id,name:this.name,state:(_TestState$this$state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState */ .t[this.state])===null||_TestState$this$state===void 0?void 0:_TestState$this$state.toLowerCase(),kind:this.nodeKind},this.customProperties());if(this.output)res.output=this.output;if(children.length>0)res.children=children;return res;};_proto.customProperties=function customProperties(){return{};};(0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(TestNode,[{key:"manualSteps",get:function get(){return this._manualSteps;}},{key:"description",get:function get(){return"";}},{key:"name",get:function get(){return this._name;},set:function set(value){if(value!==this._name){this._name=value;this.emit(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .CHANGE */ .Ver);}}},{key:"bus",get:function get(){var _this$parent2;return(_this$parent2=this.parent)===null||_this$parent2===void 0?void 0:_this$parent2.bus;}},{key:"label",get:function get(){return this._name;}},{key:"info",get:function get(){return undefined;}},{key:"factory",get:function get(){var _this$parent3;return(_this$parent3=this.parent)===null||_this$parent3===void 0?void 0:_this$parent3.factory;}},{key:"uploadState",get:function get(){return this._uploadState;},set:function set(value){if(this._uploadState!==value){this._uploadState=value;this.emit(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .CHANGE */ .Ver);}}},{key:"id",get:function get(){return this._id;}},{key:"parent",get:function get(){return this._parent;},set:function set(value){if(value!==this._parent){this.node=undefined;this._parent=value;}}},{key:"node",get:function get(){return this._node;},set:function set(value){if(value!==this._node){if(this._node){//console.log(`unbound ${this._node} from ${this}`)
}this.unmount();this._node=value;this.bindChildren();if(value){//console.log(`bound ${value} to ${this}`)
this.mount();this.updateState();}else this.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Indeterminate */ .t.Indeterminate;}}},{key:"children",get:function get(){return this._children.slice(0);}},{key:"descendants",get:function get(){return[].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(this._children),(0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)((0,_jdom_utils__WEBPACK_IMPORTED_MODULE_4__/* .arrayConcatMany */ .ue)(this._children.map(child=>child.descendants))));}},{key:"qualifiedName",get:function get(){return this._parent?this.parent+":"+this.name:this.name;}},{key:"state",get:function get(){return this._state;},set:function set(value){if(value!=this._state){var _this$parent4;this._state=value;this.emit(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .CHANGE */ .Ver);this.emit(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .STATE_CHANGE */ .HXD);(_this$parent4=this.parent)===null||_this$parent4===void 0?void 0:_this$parent4.updateState();}}},{key:"output",get:function get(){return this._output;},set:function set(value){if(this._output!==value){this._output=value;this.emit(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .CHANGE */ .Ver);}}}]);return TestNode;}(_jdom_node__WEBPACK_IMPORTED_MODULE_2__/* .JDNode */ .z);var PanelTest=/*#__PURE__*/function(_TestNode){(0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(PanelTest,_TestNode);function PanelTest(id,specification){var _this2;_this2=_TestNode.call(this,id||"panel")||this;_this2.specification=specification;return _this2;}var _proto2=PanelTest.prototype;_proto2.customProperties=function customProperties(){var _navigator;return{time:new Date().toUTCString(),userAgent:typeof navigator!=="undefined"&&((_navigator=navigator)===null||_navigator===void 0?void 0:_navigator.userAgent)};};(0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(PanelTest,[{key:"nodeKind",get:function get(){return PANEL_TEST_KIND;}},{key:"bus",get:function get(){return this.node;},set:function set(value){this.node=value;}},{key:"factory",get:function get(){return!!this.specification.factory;}},{key:"deviceTests",get:function get(){return this.children;}},{key:"label",get:function get(){var children=this.children.filter(c=>c.nodeKind===DEVICE_TEST_KIND);var found=children.filter(c=>!!c.node).length;return this.name+", found "+found+"/"+children.length+" devices";}}]);return PanelTest;}(TestNode);var DeviceTest=/*#__PURE__*/function(_TestNode2){(0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(DeviceTest,_TestNode2);function DeviceTest(productIdentifier,specification,testSpecification){var _this3;_this3=_TestNode2.call(this,specification?specification.name+" (0x"+productIdentifier.toString(16)+")":productIdentifier?"0x"+productIdentifier.toString(16):"???")||this;_this3.productIdentifier=productIdentifier;_this3.specification=specification;_this3.testSpecification=testSpecification;return _this3;}var _proto3=DeviceTest.prototype;_proto3.test=function test(device){return this.productIdentifier===device.productIdentifier;};_proto3.bind=function bind(){// clear bindings if needed
if(this.device){if(!this.device.connected)this.device=undefined;// already bound
else return;}if(!this.parent)return;var{deviceTests,specification,bus}=this.parent;var{oracles}=specification;// list unbound devices on the bus
var unboundDevices=bus.devices({ignoreInfrastructure:true})// ignore devices that are already bound
.filter(d=>!deviceTests.some(t=>t.device===d))// ignore oracles
.filter(d=>!(oracles!==null&&oracles!==void 0&&oracles.find(oracle=>oracle.deviceId===d.deviceId)));// quadratic search, find first device that matches a test
var device=unboundDevices.find(d=>this.test(d));this.device=device;};_proto3.mount=function mount(){_TestNode2.prototype.mount.call(this);var device=this.device;this.subscriptions.mount(device.subscribe(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .DISCONNECT */ .PYu,()=>{if(device===this.node)this.node=undefined;}));};_proto3.customProperties=function customProperties(){var d=this.device;if(!d)return{};return{deviceId:d.deviceId,shortId:d.shortId,firmwareVersion:d.firmwareVersion};};(0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(DeviceTest,[{key:"nodeKind",get:function get(){return DEVICE_TEST_KIND;}},{key:"device",get:function get(){return this.node;},set:function set(value){this.node=value;}},{key:"bus",get:function get(){var _this$device;return((_this$device=this.device)===null||_this$device===void 0?void 0:_this$device.bus)||_TestNode2.prototype.bus;}},{key:"factory",get:function get(){var _this$parent5;return((_this$parent5=this.parent)===null||_this$parent5===void 0?void 0:_this$parent5.factory)||!!this.testSpecification.factory;}},{key:"serviceTests",get:function get(){return this.children.filter(child=>child.nodeKind===SERVICE_TEST_KIND);}}]);return DeviceTest;}(TestNode);var DeviceStatsTest=/*#__PURE__*/function(_TestNode3){(0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(DeviceStatsTest,_TestNode3);function DeviceStatsTest(){return _TestNode3.call(this,"statistics")||this;}var _proto4=DeviceStatsTest.prototype;_proto4.bind=function bind(){var{device}=this.parent||{};this.node=device;};_proto4.mount=function mount(){var _this4=this;_TestNode3.prototype.mount.call(this);var device=this.device;var mounted=true;var work=/*#__PURE__*/function(){var _ref=(0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(function*(){while(mounted){var stats=device.stats;if(stats.restarts>=DEVICE_STATS_MAX_RESTARTS){_this4.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Fail */ .t.Fail;_this4.output="device restarted (> "+stats.restarts+" times)";break;}else if(stats.dropped>=DEVICE_STATS_MAX_DROPPED_PACKETS){_this4.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Fail */ .t.Fail;_this4.output="device dropped packets (> "+stats.dropped+")";break;}else if(stats.announce>=DEVICE_STATS_MIN_ANNOUNCE_PACKETS){_this4.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass;_this4.output="device is transferring packets correctly";}yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_4__/* .delay */ .gw)(505);}});return function work(){return _ref.apply(this,arguments);};}();work();this.subscriptions.mount(()=>{mounted=false;});};_proto4.updateState=function updateState(){// don't reset state
if(this.state!==_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Fail */ .t.Fail){this.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running;this.output="";}};(0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(DeviceStatsTest,[{key:"description",get:function get(){return"monitor device statistics (# restarts, # packets, etc.)";}},{key:"nodeKind",get:function get(){return DEVICE_STATS_TEST_KIND;}},{key:"device",get:function get(){return this.node;}}]);return DeviceStatsTest;}(TestNode);var StatusLightTest=/*#__PURE__*/function(_TestNode4){(0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(StatusLightTest,_TestNode4);function StatusLightTest(){return _TestNode4.call(this,"status light")||this;}var _proto5=StatusLightTest.prototype;_proto5.bind=function bind(){var{device}=this.parent||{};this.node=device;};_proto5.mount=function mount(){var _this5=this;_TestNode4.prototype.mount.call(this);var device=this.device;var statusLight=device===null||device===void 0?void 0:device.statusLight;if(!statusLight)return;var mounted=true;var work=/*#__PURE__*/function(){var _ref2=(0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(function*(){while(mounted&&statusLight){switch(_this5.parent.state){case _spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass:statusLight.blink(0x006000,0x000000,500,1);break;case _spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Fail */ .t.Fail:statusLight.blink(0x500000,0x000000,250,4);break;}yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_4__/* .delay */ .gw)(1000);}});return function work(){return _ref2.apply(this,arguments);};}();work();this.subscriptions.mount(()=>{mounted=false;});};_proto5.updateState=function updateState(){this.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass;};(0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(StatusLightTest,[{key:"description",get:function get(){return"slow blink (2x/s green) = pass, fast blink (4x/s red) = fail";}},{key:"nodeKind",get:function get(){return STATUS_LIGHT_TEST_KIND;}},{key:"device",get:function get(){return this.node;}}]);return StatusLightTest;}(TestNode);var ServiceTest=/*#__PURE__*/function(_TestNode5){(0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(ServiceTest,_TestNode5);function ServiceTest(name,serviceClass){var _this6;_this6=_TestNode5.call(this,name)||this;_this6.serviceClass=serviceClass;return _this6;}var _proto6=ServiceTest.prototype;_proto6.test=function test(service){return service.serviceClass===this.serviceClass;};_proto6.bind=function bind(){if(this.service||!this.parent)return;var{serviceTests,device}=this.parent;var unboundServices=device.services({serviceClass:this.serviceClass}).filter(srv=>!serviceTests.find(st=>st.node===srv));var service=unboundServices.find(srv=>this.test(srv));this.service=service;};_proto6.customProperties=function customProperties(){var s=this.service;if(!s)return{};return{serviceClass:s.serviceClass.toString(16),serviceIndex:s.serviceIndex};};(0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(ServiceTest,[{key:"nodeKind",get:function get(){return SERVICE_TEST_KIND;}},{key:"service",get:function get(){return this.node;},set:function set(value){this.node=value;}}]);return ServiceTest;}(TestNode);var ServiceMemberTestNode=/*#__PURE__*/function(_TestNode6){(0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(ServiceMemberTestNode,_TestNode6);function ServiceMemberTestNode(name,manualSteps){return _TestNode6.call(this,name,manualSteps)||this;}(0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(ServiceMemberTestNode,[{key:"service",get:function get(){if(!this.parent)return undefined;var{service}=this.parent;return service;}}]);return ServiceMemberTestNode;}(TestNode);var ServiceCommandTest=/*#__PURE__*/function(_ServiceMemberTestNod){(0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(ServiceCommandTest,_ServiceMemberTestNod);function ServiceCommandTest(options){var _this7;_this7=_ServiceMemberTestNod.call(this,options.name,options.manualSteps)||this;_this7.options=options;return _this7;}var _proto7=ServiceCommandTest.prototype;_proto7.updateState=function updateState(){var _this$options;if((_this$options=this.options)!==null&&_this$options!==void 0&&_this$options.hasChildren)_ServiceMemberTestNod.prototype.updateState.call(this);};_proto7.mount=function mount(){_ServiceMemberTestNod.prototype.mount.call(this);var service=this.service;var{start}=this.options;if(service){var unsubscribe=start(this);this.subscriptions.mount(unsubscribe);}};_proto7.bind=function bind(){this.node=this.service;};(0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(ServiceCommandTest,[{key:"nodeKind",get:function get(){return SERVICE_COMMAND_TEST_KIND;}}]);return ServiceCommandTest;}(ServiceMemberTestNode);var RegisterTestNode=/*#__PURE__*/function(_ServiceMemberTestNod2){(0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(RegisterTestNode,_ServiceMemberTestNod2);function RegisterTestNode(name,manualSteps,code){var _this8;_this8=_ServiceMemberTestNod2.call(this,name,manualSteps)||this;_this8.code=code;return _this8;}var _proto8=RegisterTestNode.prototype;_proto8.mount=function mount(){_ServiceMemberTestNod2.prototype.mount.call(this);var register=this.register;//console.log(`register subscribe ${this.code} to ${register}`)
this.subscriptions.mount(register.subscribe(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .REPORT_UPDATE */ .rGZ,()=>{this.updateState();this.emit(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .CHANGE */ .Ver);}));this.updateState();};(0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(RegisterTestNode,[{key:"register",get:function get(){return this.node;},set:function set(value){this.node=value;}},{key:"description",get:function get(){var _this$register;var specification=(_this$register=this.register)===null||_this$register===void 0?void 0:_this$register.specification;return specification===null||specification===void 0?void 0:specification.description;}},{key:"info",get:function get(){var _this$register2;return((_this$register2=this.register)===null||_this$register2===void 0?void 0:_this$register2.humanValue)||"?";}}]);return RegisterTestNode;}(ServiceMemberTestNode);var RegisterOracle=/*#__PURE__*/function(_RegisterTestNode){(0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(RegisterOracle,_RegisterTestNode);function RegisterOracle(name,deviceId,serviceIndex,serviceClass,tolerance){var _this9;_this9=_RegisterTestNode.call(this,name,undefined,_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SystemReg.Reading */ .ZJq.Reading)||this;_this9.deviceId=deviceId;_this9.serviceIndex=serviceIndex;_this9.serviceClass=serviceClass;_this9.tolerance=tolerance;return _this9;}var _proto9=RegisterOracle.prototype;_proto9.nodeState=function nodeState(){var _this$register3,_this$register3$unpac;return{state:(_this$register3=this.register)!==null&&_this$register3!==void 0&&(_this$register3$unpac=_this$register3.unpackedValue)!==null&&_this$register3$unpac!==void 0&&_this$register3$unpac.length?_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass:_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Fail */ .t.Fail};};_proto9.bind=function bind(){if(this.register||!this.parent)return;var device=this.bus.device(this.deviceId,true);var service=device===null||device===void 0?void 0:device.services({serviceIndex:this.serviceIndex,serviceClass:this.serviceClass})[0];var register=service===null||service===void 0?void 0:service.register(this.code);this.register=register;};(0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(RegisterOracle,[{key:"nodeKind",get:function get(){return REGISTER_ORACLE_KIND;}}]);return RegisterOracle;}(RegisterTestNode);var RegisterTest=/*#__PURE__*/function(_RegisterTestNode2){(0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(RegisterTest,_RegisterTestNode2);function RegisterTest(name,manualSteps,code,computeState){var _this10;_this10=_RegisterTestNode2.call(this,name,manualSteps,code)||this;_this10.computeState=computeState;return _this10;}var _proto10=RegisterTest.prototype;_proto10.nodeState=function nodeState(){var register=this.register;var log=[];var logger=msg=>{msg&&log.push(msg);};var state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Indeterminate */ .t.Indeterminate;if(register){try{var _register$service,_register$service$dev;// always turn off color before querying service
var statusLight=(_register$service=register.service)===null||_register$service===void 0?void 0:(_register$service$dev=_register$service.device)===null||_register$service$dev===void 0?void 0:_register$service$dev.statusLight;statusLight===null||statusLight===void 0?void 0:statusLight.setColor(0);state=this.computeState(this,logger);}catch(e){state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Fail */ .t.Fail;logger(e===null||e===void 0?void 0:e.toString());}}return{state,output:log!==null&&log!==void 0&&log.length?log.join("\n"):undefined};};_proto10.bind=function bind(){var service=this.service;var register=service===null||service===void 0?void 0:service.register(this.code);this.register=register;};(0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(RegisterTest,[{key:"nodeKind",get:function get(){return REGISTER_TEST_KIND;}}]);return RegisterTest;}(RegisterTestNode);var EventTest=/*#__PURE__*/function(_ServiceMemberTestNod3){(0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(EventTest,_ServiceMemberTestNod3);function EventTest(name,manualSteps,code,computeState){var _this11;_this11=_ServiceMemberTestNod3.call(this,name,manualSteps)||this;_this11.code=code;_this11.computeState=computeState;return _this11;}var _proto11=EventTest.prototype;_proto11.mount=function mount(){_ServiceMemberTestNod3.prototype.mount.call(this);var event=this.event;//console.log(`event subscribe ${this.code} to ${event}`)
this.subscriptions.mount(event.subscribe(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .EVENT */ .Ks0,()=>{this.updateState();this.emit(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .CHANGE */ .Ver);}));};_proto11.nodeState=function nodeState(){var event=this.event;var log=[];var logger=msg=>{msg&&log.push(msg);};var state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Indeterminate */ .t.Indeterminate;if(event){try{state=this.computeState(this,logger);}catch(e){state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Fail */ .t.Fail;logger(e===null||e===void 0?void 0:e.toString());}}return{state,output:log.join("\n")};};_proto11.bind=function bind(){var service=this.service;var event=service===null||service===void 0?void 0:service.event(this.code);this.event=event;};(0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(EventTest,[{key:"nodeKind",get:function get(){return EVENT_TEST_KIND;}},{key:"event",get:function get(){return this.node;},set:function set(value){this.node=value;}},{key:"description",get:function get(){var _this$event;var specification=(_this$event=this.event)===null||_this$event===void 0?void 0:_this$event.specification;return specification===null||specification===void 0?void 0:specification.description;}},{key:"info",get:function get(){var _this$event2;var c=(_this$event2=this.event)===null||_this$event2===void 0?void 0:_this$event2.count;return c?"#"+c:"?";}}]);return EventTest;}(ServiceMemberTestNode);

/***/ }),

/***/ 40914:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "t": function() { return /* binding */ TestState; },
/* harmony export */   "k": function() { return /* binding */ TestUploadState; }
/* harmony export */ });
var TestState;(function(TestState){TestState[TestState["Pass"]=0]="Pass";TestState[TestState["Indeterminate"]=1]="Indeterminate";TestState[TestState["Running"]=2]="Running";TestState[TestState["Fail"]=3]="Fail";})(TestState||(TestState={}));var TestUploadState;(function(TestUploadState){TestUploadState[TestUploadState["Local"]=0]="Local";TestUploadState[TestUploadState["Uploading"]=1]="Uploading";TestUploadState[TestUploadState["Uploaded"]=2]="Uploaded";TestUploadState[TestUploadState["UploadError"]=3]="UploadError";})(TestUploadState||(TestUploadState={}));

/***/ }),

/***/ 45665:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "f2": function() { return /* binding */ resolveTestRules; },
/* harmony export */   "Uo": function() { return /* binding */ resolveReadingTolerage; },
/* harmony export */   "c8": function() { return /* binding */ resolveServiceCommandTest; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(15785);
/* harmony import */ var _babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(15861);
/* harmony import */ var _jdom_constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(3964);
/* harmony import */ var _jdom_light__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(95247);
/* harmony import */ var _jdom_pack__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(71670);
/* harmony import */ var _jdom_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(46196);
/* harmony import */ var _nodes__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(32098);
/* harmony import */ var _spec__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(40914);
var testColors=[0x220000,0x002200,0x000022,0];var builtinTestRules={[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_SWITCH */ .Crg]:[{type:"reading",value:0,manualSteps:{prepare:"switch to inactive"}},{type:"reading",value:1,manualSteps:{prepare:"switch to active"}}],[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_RELAY */ .E4D]:[{type:"intensity",value:0,factory:true},{type:"intensity",value:1,factory:true},{type:"setIntensityAndValue",name:"activate and deactive every 3s",factory:true,steps:[{duration:3000,intensity:0},{duration:3000,intensity:1}]}],[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_ACCELEROMETER */ .QF7]:[{type:"event",eventName:"face_up",manualSteps:{prepare:"turn face up"}},{type:"event",eventName:"face_down",manualSteps:{prepare:"turn face down"}},{type:"event",eventName:"tilt_up",factory:true,manualSteps:{prepare:"tilt up"}},{type:"event",eventName:"tilt_down",factory:true,manualSteps:{prepare:"tilt down"}},{type:"event",eventName:"tilt_left",factory:true,manualSteps:{prepare:"tilt left"}},{type:"event",eventName:"tilt_right",factory:true,manualSteps:{prepare:"tilt right"}},{type:"event",eventName:"shake",manualSteps:{prepare:"shake device"}}],[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_BUTTON */ .XJR]:[{type:"reading",value:0,tolerance:0.001,factory:true,manualSteps:{prepare:"release button"}},{type:"reading",value:1,tolerance:0.001,factory:true,manualSteps:{prepare:"press button"}},{type:"event",eventName:"down",factory:true},{type:"event",eventName:"up",factory:true}],[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_REFLECTED_LIGHT */ .tky]:[{type:"reading",value:0,tolerance:0.3,factory:true,manualSteps:{prepare:"place the sensor over a dark surface"}},{type:"reading",value:0,tolerance:0.3,factory:true,manualSteps:{prepare:"place the sensor over a light surface"}}],[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_MOTION */ .yRl]:[{type:"reading",value:0,factory:true,manualSteps:{prepare:"do not move"}},{type:"reading",value:1,factory:true,manualSteps:{prepare:"move"}},{type:"event",eventName:"movement",factory:true}],[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_MAGNETIC_FIELD_LEVEL */ .VC9]:[{type:"reading",value:0,tolerance:0.2,factory:true,manualSteps:{prepare:"remove magnet"}},{type:"reading",value:1,tolerance:0.3,factory:true,manualSteps:{prepare:"place north pole on top of sensor"}},{type:"reading",value:-1,tolerance:0.3,factory:true,manualSteps:{prepare:"place south pole on top of sensor"}}],[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_DISTANCE */ .Sfn]:[{type:"reading",value:0.2,samples:1,factory:true,op:"<",manualSteps:{prepare:"cover distance sensor to get a reading less than 20cm"}},{type:"reading",value:0.4,samples:1,factory:true,manualSteps:{prepare:"uncover distance sensor with at least 40cm free"},op:">"}],[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_SOIL_MOISTURE */ .Bj3]:[{type:"reading",value:0,tolerance:0.2,factory:true,manualSteps:{prepare:"dip in dry dirt"}},{type:"reading",value:1,tolerance:0.2,factory:true,manualSteps:{prepare:"dip in wet dirt"}}],[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_POTENTIOMETER */ .GQv]:[{type:"reading",value:0,tolerance:0.01,factory:true,manualSteps:{prepare:"slide to minimum"}},{type:"reading",value:0.5,tolerance:0.01,manualSteps:{prepare:"slide to middle"}},{type:"reading",value:1,tolerance:0.01,factory:true,manualSteps:{prepare:"slide to maximum"}}],[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_LIGHT_LEVEL */ .pPH]:[{type:"reading",value:0,tolerance:0.1,factory:true,manualSteps:{prepare:"cover sensor to block light"}},{type:"reading",value:1,tolerance:0.1,factory:true,manualSteps:{prepare:"apply bright light to sensor"}}],[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_ROTARY_ENCODER */ .lNp]:[{type:"reading",value:-2},{type:"reading",value:-1,factory:true},{type:"reading",value:0,factory:true},{type:"reading",value:1,factory:true},{type:"reading",value:2}]};var builtinReadingTolerances={[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_TEMPERATURE */ .ToE]:2,[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_HUMIDITY */ .JbI]:4};function resolveTestRules(serviceClass){return builtinTestRules[serviceClass];}function resolveReadingTolerage(serviceClass){return builtinReadingTolerances[serviceClass];}function createGamepadButtonTests(test,buttons){var addReadingTest=(name,flag)=>{var seenEventArg=false;test.appendChild(new _nodes__WEBPACK_IMPORTED_MODULE_4__/* .RegisterTest */ .O7(name+" reading",{prepare:"press "+name+" button"},_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .GamepadReg.Direction */ .XTX.Direction,(node,logger)=>{var{register}=node;var[buttons]=register.unpackedValue||[];var seen=!!(buttons&flag);if(!seenEventArg&&!seen)logger("reading not observed or incorrect flag");else if(seen){seenEventArg=seen;}return seenEventArg?_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass:_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running;}));};var addEventTest=(name,flag)=>{var seenEventArg=false;test.appendChild(new _nodes__WEBPACK_IMPORTED_MODULE_4__/* .EventTest */ .CK(name+" event",{prepare:"press "+name+" button to raise event"},_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .GamepadEvent.ButtonsChanged */ .Zm2.ButtonsChanged,(node,logger)=>{var{event}=node;var seen=!!((event===null||event===void 0?void 0:event.count)>0&&(event===null||event===void 0?void 0:event.data[0])&flag);if(!seenEventArg&&!seen)logger("event not observed or incorrect flag");else if(seen){seenEventArg=seen;}return seenEventArg?_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass:_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running;}));};if(test.children.length!==0)return;// TODO: revisit this
for(var key in _jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .GamepadButtons */ .p69){var value=parseInt(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .GamepadButtons */ .p69[key]);if(!isNaN(value)){if(value&buttons){addReadingTest(key,value);addEventTest(key,value);}}}// if buttons doesn't have any of L/R/D/U, then add the four events,
// as we have a analog joystick that will generate them
var LRUD=[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .GamepadButtons.Down */ .p69.Down,_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .GamepadButtons.Up */ .p69.Up,_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .GamepadButtons.Left */ .p69.Left,_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .GamepadButtons.Right */ .p69.Right];if(!(buttons&(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .GamepadButtons.Down */ .p69.Down|_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .GamepadButtons.Up */ .p69.Up|_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .GamepadButtons.Left */ .p69.Left|_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .GamepadButtons.Right */ .p69.Right))){LRUD.forEach(value=>{var key=_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .GamepadButtons */ .p69[value];addReadingTest(key,value);addEventTest(key,value);});}}var builtinServiceCommandTests={[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_GAMEPAD */ .fNW]:{name:"buttons and events",start:test=>{var service=test.service;var buttonsAvailable=service.register(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .GamepadReg.ButtonsAvailable */ .XTX.ButtonsAvailable);var buttons=buttonsAvailable.unpackedValue;if((buttons===null||buttons===void 0?void 0:buttons.length)>0){createGamepadButtonTests(test,buttons[0]);return undefined;}else{var unsubscribe=buttonsAvailable.subscribe(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .REPORT_UPDATE */ .rGZ,()=>{unsubscribe();createGamepadButtonTests(test,buttonsAvailable.unpackedValue[0]);});return unsubscribe;}},hasChildren:true},[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_DOT_MATRIX */ .GDq]:{name:"blink matrix",manualSteps:{validate:"verify all LEDs blink"},start:test=>{var service=test.service;var{factory}=test;var mounted=true;var work=/*#__PURE__*/function(){var _ref=(0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(function*(){test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running;var dotsRegister=service.register(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .DotMatrixReg.Dots */ .v$D.Dots);var brightnessRegister=service.register(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .DotMatrixReg.Brightness */ .v$D.Brightness);var dots=undefined;while(dots===undefined&&mounted){yield dotsRegister.refresh(true);dots=dotsRegister.unpackedValue[0];}var state=0xff;var brightness=1;while(mounted){dots.fill(state);yield Promise.all([brightnessRegister.sendSetPackedAsync([brightness]),dotsRegister.sendSetPackedAsync([dots])]);brightnessRegister.scheduleRefresh();dotsRegister.scheduleRefresh();if(state>0)brightness=(brightness+0.1)%1.01;state=~state;yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(500);if(factory&&test.state==_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running)test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass;}});return function work(){return _ref.apply(this,arguments);};}();work();return()=>{mounted=false;};}},[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_LED */ .i04]:{name:"cycle red, green, blue colors on all LEDs starting from the connector, clockwize.",manualSteps:{validate:"verify colors on LED"},start:test=>{var service=test.service;var factory=test.factory;var mounted=true;var work=/*#__PURE__*/function(){var _ref2=(0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(function*(){test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running;var pixelsRegister=service.register(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .LedReg.Pixels */ .Abo.Pixels);var numPixelsRegister=service.register(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .LedReg.NumPixels */ .Abo.NumPixels);var n=undefined;while(n===undefined&&mounted){yield numPixelsRegister.refresh(true);n=numPixelsRegister.uintValue;}if(n==0){test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Fail */ .t.Fail;test.output="number of pixels is 0";return;}// cycle through color and turn on pixels one by one
var pixels=new Uint8Array(n*3);var k=0;while(mounted){if(factory){// factory test: render all leds
var color=testColors[k++%testColors.length];for(var i=0;i<n;++i){pixels[i*3]=color>>16&0xff;pixels[i*3+1]=color>>8&0xff;pixels[i*3+2]=color>>0&0xff;}yield pixelsRegister.sendSetPackedAsync([pixels],true);yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(500);if(test.state==_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running)test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass;}else{// non factory test: render led one by one
for(var ci=0;ci<testColors.length&&mounted;++ci){var _color=testColors[ci];pixels.fill(0);for(var _i=0;_i<n&&mounted;++_i){pixels[_i*3]=_color>>16&0xff;pixels[_i*3+1]=_color>>8&0xff;pixels[_i*3+2]=_color>>0&0xff;yield pixelsRegister.sendSetPackedAsync([pixels],true);yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(Math.max(100,500-_i*20));}if(factory&&test.state==_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running)test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass;// pause for a second
yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(1000);pixels.fill(0);if(!mounted)break;yield pixelsRegister.sendSetPackedAsync([pixels],true);yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(500);}}}});return function work(){return _ref2.apply(this,arguments);};}();work();return()=>{mounted=false;};}},[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_SERVO */ .$X_]:{name:"change angle",manualSteps:{validate:"verify arm is moving between 0 (min), 1/3, 1/2, and 1 (max)"},start:test=>{var{factory}=test;var mounted=true;var work=/*#__PURE__*/function(){var _ref3=(0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(function*(){test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running;var service=test.service;var enabled=service.intensityRegister;var angleRegister=service.valueRegister;var actualAngleRegister=service.readingRegister;var minAngleRegister=service.register(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .ServoReg.MinAngle */ .pmu.MinAngle);var maxAngleRegister=service.register(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .ServoReg.MaxAngle */ .pmu.MaxAngle);var _loop=function*_loop(){var _minAngleRegister$unp,_maxAngleRegister$unp;yield minAngleRegister.refresh();yield maxAngleRegister.refresh();var minAngle=((_minAngleRegister$unp=minAngleRegister.unpackedValue)===null||_minAngleRegister$unp===void 0?void 0:_minAngleRegister$unp[0])||0;var maxAngle=(maxAngleRegister===null||maxAngleRegister===void 0?void 0:(_maxAngleRegister$unp=maxAngleRegister.unpackedValue)===null||_maxAngleRegister$unp===void 0?void 0:_maxAngleRegister$unp[0])||0;var na=9;var da=(maxAngle-minAngle)/(na-1);var angles=[].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(Array(na).fill(0).map((_,i)=>minAngle+i*da)),(0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(Array(na).fill(0).map((_,i)=>maxAngle-i*da)));var tolerance=(maxAngle-minAngle)/10;// min angle
for(var angle of angles){if(!mounted)break;yield enabled.sendSetBoolAsync(true);yield angleRegister.sendSetPackedAsync([angle]);yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(700);yield angleRegister.sendGetAsync();yield actualAngleRegister.sendGetAsync();if(!actualAngleRegister.notImplemented){var _angleRegister$unpack,_actualAngleRegister$;var _angle=(_angleRegister$unpack=angleRegister.unpackedValue)===null||_angleRegister$unpack===void 0?void 0:_angleRegister$unpack[0];var actualAngle=(_actualAngleRegister$=actualAngleRegister.unpackedValue)===null||_actualAngleRegister$===void 0?void 0:_actualAngleRegister$[0];if(Math.abs(actualAngle-_angle)>tolerance){test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Fail */ .t.Fail;test.output="expected angle "+_angle+", got actual angle "+actualAngle;}}}if(factory&&test.state==_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running)test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass;};while(mounted){yield*_loop();}// turn off servo
yield enabled.sendSetBoolAsync(false);});return function work(){return _ref3.apply(this,arguments);};}();work();return()=>{mounted=false;};}},[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_LED_STRIP */ .w1B]:{name:"cycle red, green, blue colors on all LEDs",manualSteps:{validate:"verify colors on LED"},start:test=>{var{factory}=test;var mounted=true;var work=/*#__PURE__*/function(){var _ref4=(0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(function*(){test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running;var service=test.service;var k=0;while(mounted){var color=testColors[k++%testColors.length];var encoded=(0,_jdom_light__WEBPACK_IMPORTED_MODULE_1__/* .lightEncode */ ._)("setall #\n                            show 20",[color]);yield service===null||service===void 0?void 0:service.sendCmdAsync(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .LedStripCmd.Run */ .HKZ.Run,encoded);yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(500);if(factory&&test.state==_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running)test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass;}});return function work(){return _ref4.apply(this,arguments);};}();work();return()=>{mounted=false;};}},[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_BUZZER */ .J1$]:{name:"beeps every 200ms every 1s, with increasing frequency",manualSteps:{validate:"sounds can be heard"},start:test=>{var{factory}=test;var mounted=true;var pack=(frequency,ms,volume)=>{var period=1000000/frequency|0;var duty=period*volume>>11;return (0,_jdom_pack__WEBPACK_IMPORTED_MODULE_2__/* .jdpack */ .AV)("u16 u16 u16",[period,duty,ms]);};var work=/*#__PURE__*/function(){var _ref5=(0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(function*(){test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running;var f=440;while(mounted){var service=test.service;if(!service){yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(500);return;}yield service.sendCmdAsync(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .BuzzerCmd.PlayTone */ .Rv2.PlayTone,pack(f,200,20));yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(1000);f=f<<1;if(f>4096)f=440;if(factory&&test.state==_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running)test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass;}});return function work(){return _ref5.apply(this,arguments);};}();// start work async
work();return()=>{mounted=false;};}},[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_POWER */ .mQG]:{name:"power on/off at a 3s interval",manualSteps:{validate:"power can be observed"},start:test=>{var{factory}=test;var INTERVAL=3000;var mounted=true;var work=/*#__PURE__*/function(){var _ref6=(0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(function*(){test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running;while(mounted){var _powerStatus$unpacked,_powerStatus$unpacked2;var service=test.service;if(!service){yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(500);return;}var ok=true;var allowed=service.register(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .PowerReg.Allowed */ .$xp.Allowed);var powerStatus=service.register(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .PowerReg.PowerStatus */ .$xp.PowerStatus);var currentDraw=service.register(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .PowerReg.CurrentDraw */ .$xp.CurrentDraw);yield allowed.sendSetBoolAsync(true,true);yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(INTERVAL);yield powerStatus.refresh();// check state
if(((_powerStatus$unpacked=powerStatus.unpackedValue)===null||_powerStatus$unpacked===void 0?void 0:_powerStatus$unpacked[0])!=_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .PowerPowerStatus.Powering */ .p6N.Powering){test.output="power status is not powering";ok=false;}else if(!currentDraw.notImplemented){yield currentDraw.refresh();if(currentDraw.uintValue==0){test.output="current draw is 0";ok=false;}}// turn off power
yield allowed.sendSetBoolAsync(false,true);yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(INTERVAL);// check state
yield powerStatus.refresh();if(((_powerStatus$unpacked2=powerStatus.unpackedValue)===null||_powerStatus$unpacked2===void 0?void 0:_powerStatus$unpacked2[0])!=_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .PowerPowerStatus.Disallowed */ .p6N.Disallowed){test.output="power status is not dissallowed";ok=false;}else if(!currentDraw.notImplemented){yield currentDraw.refresh();if(currentDraw.uintValue!=0){test.output="current draw is 0";ok=false;}}if(ok&&factory&&test.state==_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running)test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass;}});return function work(){return _ref6.apply(this,arguments);};}();// start work async
work();return()=>{mounted=false;};}},[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_VIBRATION_MOTOR */ .X8d]:{name:"vibration with increasing duration, strength",manualSteps:{validate:"vibration can be detected"},start:test=>{var{factory}=test;var MAX_DURATION=512;var mounted=true;var pack=(ms,volume)=>{return (0,_jdom_pack__WEBPACK_IMPORTED_MODULE_2__/* .jdpack */ .AV)("r: u8 u0.8",[[[ms>>3,volume]]]);};var work=/*#__PURE__*/function(){var _ref7=(0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(function*(){test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running;var ms=64;while(mounted){var service=test.service;if(!service){yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(500);return;}yield service.sendCmdAsync(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .VibrationMotorCmd.Vibrate */ .EmZ.Vibrate,pack(ms,ms/MAX_DURATION));yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(ms+1000);ms=ms<<1;if(ms>MAX_DURATION){ms=64;if(factory&&test.state==_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running)test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass;}}});return function work(){return _ref7.apply(this,arguments);};}();// start work async
work();return()=>{mounted=false;};}},[_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .SRV_ROTARY_ENCODER */ .lNp]:{name:"rotate clockwise slowly 1 full turn, without missing a click",start:test=>{var{factory}=test;var mounted=true;var work=/*#__PURE__*/function(){var _ref8=(0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(function*(){test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running;var service=test.service;var clicksPerTurnRegister=service.register(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .RotaryEncoderReg.ClicksPerTurn */ .$v5.ClicksPerTurn);var positionRegister=service.register(_jdom_constants__WEBPACK_IMPORTED_MODULE_0__/* .RotaryEncoderReg.Position */ .$v5.Position);// read number of clicks
test.output="reading clicks per turn";var clicksPerTurn=0;while(mounted&&!clicksPerTurn){var _clicksPerTurnRegiste;yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(100);yield clicksPerTurnRegister.refresh();clicksPerTurn=(_clicksPerTurnRegiste=clicksPerTurnRegister.unpackedValue)===null||_clicksPerTurnRegiste===void 0?void 0:_clicksPerTurnRegiste[0];}var lastPosition=undefined;var count=0;while(mounted){var _positionRegister$unp;yield positionRegister.refresh();var position=(_positionRegister$unp=positionRegister.unpackedValue)===null||_positionRegister$unp===void 0?void 0:_positionRegister$unp[0];if(lastPosition===position)yield (0,_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(20);else if(lastPosition===undefined||(lastPosition+1)%clicksPerTurn===position%clicksPerTurn){lastPosition=position%clicksPerTurn;count++;if(count===clicksPerTurn){test.output=count+"/"+clicksPerTurn+" at "+lastPosition;test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass;break;}}else{lastPosition=position%clicksPerTurn;count=0;}test.output=count+"/"+clicksPerTurn+" at "+lastPosition;if(factory&&test.state==_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Running */ .t.Running)test.state=_spec__WEBPACK_IMPORTED_MODULE_5__/* .TestState.Pass */ .t.Pass;}// look for full sequence
});return function work(){return _ref8.apply(this,arguments);};}();work();return()=>{mounted=false;};}}};function resolveServiceCommandTest(serviceClass){return builtinServiceCommandTests[serviceClass];}

/***/ })

}]);
//# sourceMappingURL=2c0fffe43fb9a4b5d22760a26753e0b3e19127dd-cecd6f8b95152a55834f.js.map