{"version":3,"file":"7953-ab489a4c03698236ef63.js","mappings":"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","sources":["webpack://jacdac-docs/./node_modules/@mui/icons-material/PowerSettingsNew.js","webpack://jacdac-docs/./src/components/dashboard/DashboardBrailleDisplay.tsx"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M13 3h-2v10h2V3zm4.83 2.17-1.42 1.42C17.99 7.86 19 9.81 19 12c0 3.87-3.13 7-7 7s-7-3.13-7-7c0-2.19 1.01-4.14 2.58-5.42L6.17 5.17C4.23 6.82 3 9.26 3 12c0 4.97 4.03 9 9 9s9-4.03 9-9c0-2.74-1.23-5.18-3.17-6.83z\"\n}), 'PowerSettingsNew');\nexports.default = _default;","import React, { ChangeEvent, useEffect, useState } from \"react\"\nimport { BrailleDisplayReg } from \"../../../jacdac-ts/src/jdom/constants\"\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\"\nimport {\n    useRegisterBoolValue,\n    useRegisterUnpackedValue,\n} from \"../../jacdac/useRegisterValue\"\nimport { Grid, TextField } from \"@mui/material\"\nimport useRegister from \"../hooks/useRegister\"\nimport CmdButton from \"../CmdButton\"\nimport ClearIcon from \"@mui/icons-material/Clear\"\nimport CharacterScreenWidget from \"../widgets/CharacterScreenWidget\"\nimport { useId } from \"react\"\nimport PowerSettingsNewIcon from \"@mui/icons-material/PowerSettingsNew\"\nimport DashboardRegisterValueFallback from \"./DashboardRegisterValueFallback\"\n\n// https://en.wikipedia.org/wiki/Braille_ASCII\n/** \nconst ascii = \" A1B'K2L@CIF/MSP\\\"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\\\0Z7(_?W]#Y)=\"\nconst unicode = \"⠀⠁⠂⠃⠄⠅⠆⠇⠈⠉⠊⠋⠌⠍⠎⠏⠐⠑⠒⠓⠔⠕⠖⠗⠘⠙⠚⠛⠜⠝⠞⠟⠠⠡⠢⠣⠤⠥⠦⠧⠨⠩⠪⠫⠬⠭⠮⠯⠰⠱⠲⠳⠴⠵⠶⠷⠸⠹⠺⠻⠼⠽⠾⠿\"\nconst a0 = \" \".charCodeAt(0)\nlet r = ''\nfor (let i = 0; i < 64; ++i) {\n    const c = String.fromCharCode(a0 + i)\n    const j = ascii.indexOf(c)\n    const u = unicode.charAt(j)\n    r += u\n}\nconsole.log(r)\n */\nfunction brailify(s: string) {\n    if (!s) return s\n    // space char -> unicode character\n    const braille_ascii = \"⠀⠮⠐⠼⠫⠩⠯⠄⠷⠾⠡⠬⠠⠤⠨⠌⠴⠂⠆⠒⠲⠢⠖⠶⠦⠔⠱⠰⠣⠿⠜⠹⠈⠁⠃⠉⠙⠑⠋⠛⠓⠊⠚⠅⠇⠍⠝⠕⠏⠟⠗⠎⠞⠥⠧⠺⠭⠽⠵⠪⠳⠻⠘⠸\"\n    const a0 = \" \".charCodeAt(0)\n    const an = braille_ascii.length\n\n    let r = \"\"\n    const su = s.toLocaleUpperCase()\n    for (let i = 0; i < su.length; ++i) {\n        const c = su.charCodeAt(i)\n        const ai = c - a0\n        if (c >= 0x2800 && c <= 0x28ff) r += String.fromCharCode(c)\n        else if (ai < an) r += braille_ascii.charAt(ai)\n        else r += \"\"\n    }\n    return r\n}\n\nexport default function DashboardBrailleDisplay(props: DashboardServiceProps) {\n    const { service, expanded } = props\n    const textId = useId()\n\n    const patternsRegister = useRegister(service, BrailleDisplayReg.Patterns)\n    const lengthRegister = useRegister(service, BrailleDisplayReg.Length)\n    const enabledRegister = useRegister(service, BrailleDisplayReg.Enabled)\n    const [patterns] = useRegisterUnpackedValue<[string]>(\n        patternsRegister,\n        props\n    )\n    const enabled = useRegisterBoolValue(enabledRegister, props)\n    const [length] = useRegisterUnpackedValue<[number]>(lengthRegister, props)\n\n    const [fieldMessage, setFieldMessage] = useState(patterns)\n    const handleFieldMessageChange = async (\n        ev: ChangeEvent<HTMLTextAreaElement>\n    ) => {\n        const text = ev.target.value\n        const brailled = brailify(text)\n        setFieldMessage(text)\n        await patternsRegister.sendSetStringAsync(brailled, true)\n    }\n    const handleClear = async () => {\n        setFieldMessage(\"\")\n        await patternsRegister.sendSetStringAsync(\"\", true)\n    }\n    const handleEnabled = async () =>\n        await enabledRegister.sendSetBoolAsync(!enabled, true)\n    // set first value of message\n    useEffect(() => {\n        if (!fieldMessage && patterns) setFieldMessage(patterns)\n    }, [patterns])\n\n    if (length === undefined)\n        return <DashboardRegisterValueFallback register={lengthRegister} />\n\n    return (\n        <Grid container spacing={1} alignItems=\"center\">\n            {expanded && (\n                <Grid item xs={12}>\n                    <Grid container spacing={1}>\n                        <Grid item xs>\n                            <TextField\n                                id={textId}\n                                label=\"text\"\n                                helperText=\"Unicode Braille patterns or Braille ASCII\"\n                                aria-label=\"text field to enter Braille unicode pattersn or Braille ASCII\"\n                                value={fieldMessage}\n                                onChange={handleFieldMessageChange}\n                                multiline={false}\n                                fullWidth={true}\n                                disabled={!enabled}\n                            />\n                        </Grid>\n                        <Grid item>\n                            <CmdButton\n                                title=\"clear the entire display\"\n                                onClick={handleClear}\n                                icon={<ClearIcon />}\n                            />\n                        </Grid>\n                    </Grid>\n                </Grid>\n            )}\n            <Grid item xs>\n                <CharacterScreenWidget\n                    rows={1}\n                    columns={length}\n                    message={patterns}\n                    disabled={!enabled}\n                />\n            </Grid>\n            <Grid item>\n                <CmdButton\n                    title={enabled ? \"disable display\" : \"enable display\"}\n                    onClick={handleEnabled}\n                    color={enabled ? \"primary\" : undefined}\n                    icon={<PowerSettingsNewIcon />}\n                />\n            </Grid>\n        </Grid>\n    )\n}\n"],"names":["braille_ascii","a0","an","r","su","s","i","c","ai","String","textId","useId","patternsRegister","useRegister","BrailleDisplayReg","lengthRegister","enabledRegister","useRegisterUnpackedValue","enabled","useRegisterBoolValue","useState","handleFieldMessageChange","text","ev","brailled","brailify","setFieldMessage","handleClear","handleEnabled","useEffect","length","expanded"],"sourceRoot":""}