{"version":3,"file":"component---src-pages-tools-service-editor-tsx-603ccfefe1459a19d387.js","mappings":";;;;;;;AAAa;;AAEb,6BAA6B,mBAAO,CAAC,KAA8C;AACnF,6BAA6C;AAC7C;AACA,CAAC,CAAC;AACF,SAAe;AACf,4CAA4C,mBAAO,CAAC,KAAuB;AAC3E,kBAAkB,mBAAO,CAAC,KAAmB;AAC7C;AACA;AACA,CAAC;AACD,SAAe;;;;;;;;;;;;;;;;;;;;;;;;;ACHf;AAEA;AAQe,+BAGZ,CACC,GAAM,kBAAN,MACA,GAAM,iBAAgBA,+CAAQ,CAA9B,IAA8B,CAA9B,CACA,GAAMC,CAAAA,OAAO,CAAGC,4CAAhB,GACA,GAAMC,CAAAA,aAAa,CAAGC,8EAAtB,GAEA,GAAMC,CAAAA,OAAO,CAAG,IACZC,MAAM,CACAH,aAAa,CADb,cACAA,EADA,CAEAI,QAAQ,CACRJ,aAAa,CAAbA,gBAAAA,CAA+B,CADvB,GACRA,CADQ,CAERA,aAAa,CALvB,eAKUA,EALV,CAOA,GAAM,qBAAoBH,+CAAQ,CAACK,OAAnC,EAAkC,CAAlC,CACA,GAAM,iCAAgCL,+CAAQ,CAA9C,KAA8C,CAA9C,CAEA,GAAMQ,CAAAA,gBAAgB,CAAG,IAAM,CAC3B,GAAMC,CAAAA,CAAC,CAAGJ,OAAV,GACAK,QAAQ,CAARA,CAAQ,CAARA,CACAC,cAAc,CAAdA,KAAc,CAAdA,CAHJ,EAKA,GAAMC,CAAAA,UAAU,mIAAG,WAAY,CAC3B,GAAI,CACA,KAAMC,CAAAA,SAAS,CAATA,SAAAA,CAAAA,SAAAA,CAAN,KAAMA,CAAN,CACAF,cAAc,CAAdA,IAAc,CAAdA,CACF,WAAY,CACVA,cAAc,CAAdA,KAAc,CAAdA,CAEP,CAPe,SAAVC,SAAAA,CAAAA,UAAAA,EAAU,qCAAhB,CAAgB,EAAhB,CAQA,GAAME,CAAAA,SAAS,CAAG,cAA0B,CACxCC,MAAM,CAANA,OAAM,CAANA,CADJ,EAGAC,gDAAS,kBAAmB,CAA5BA,GAA4B,CAAnB,CAATA,CACA,GAAMC,CAAAA,KAAK,CAAGX,MAAM,4BAEdC,QAAQ,6BAFd,4BAKA,mBACI,kIACI,kIACI,iHAAY,KAAK,CADrB,KACI,EADJ,cAEI,qHACKW,KAAK,GAALA,SAAAA,EAAAA,aACG,kHAAY,OAAO,CAAnB,KAAyB,SAAS,CAAlC,mBACI,kHACI,EAAE,CADN,QAEI,KAAK,CAFT,MAGI,QAAQ,CAHZ,KAII,UAAU,CAAE,CACR,aANZ,sBAKoB,CAJhB,EADJ,CASKC,WAAW,eAAI,6HAX5B,IAW4B,CATpB,CAFR,CAcKD,KAAK,GAALA,SAAAA,EAAAA,aACG,6GAAO,QAAQ,CAAf,SAjBZ,kDAiBY,CAfR,CAFJ,cAsBI,sHACKX,QAAQ,eACL,uHACI,KAAK,CADT,MAEI,OAAO,CAFX,IAGI,QAAQ,CALpB,SAEQ,EAFR,cAQI,yHACI,aADJ,kCAEI,IAAI,CAFR,QAGI,OAAO,CAHX,YAII,OAAO,CAJX,YARJ,MAQI,CARJ,cAgBI,yHACI,aADJ,2BAEI,IAAI,CAFR,QAGI,OAAO,CAHX,YAII,KAAK,CAJT,UAKI,OAAO,CALX,kBAxChB,YAwCgB,CAhBJ,CAtBJ,CADJ,CADJ,CAqDH;;;;;;;;;;;;;;;;;;;;;;;;ACjH0D;;AAE3D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,sBAAsB,aAAa;AACnC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,qBAAqB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,UAAU,kBAAQ,aAAa,kBAAQ;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG,WAAW,iBAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE,yBAAe;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE,yBAAe;AACjB;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,mBAAmB;AAC5C;AACA,gDAAgD,QAAQ;AACxD;AACA;AACA,8CAA8C,QAAQ;AACtD;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;;;;;;;;;;;;ACtRA,uDACA,kCAOA;AAEA;AAQA,GAAMa,CAAAA,uBAAuB,cAAGC,cAAI,CAChC,IAAM,kQAD0B,CAApC,CAIA,GAAMC,CAAAA,iBAAiB,CAAGC,0BAAM,CAANA,sBAAM,CAANA,CAAgB,UAAC,CAAD,KAAC,EAAD,WAAgB,CACtD,aAAc,CACVC,KAAK,CAAEC,KAAK,CAALA,OAAAA,CAAAA,KAAAA,CAF2C,IACx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","sources":["webpack://jacdac-docs/./node_modules/@mui/icons-material/Check.js","webpack://jacdac-docs/./src/components/RandomGenerator.tsx","webpack://jacdac-docs/./node_modules/use-editable/dist/use-editable.es.js","webpack://jacdac-docs/./src/components/ui/HighlightTextField.tsx","webpack://jacdac-docs/./src/components/specification/ServiceSpecificationSource.tsx","webpack://jacdac-docs/./src/components/tools/ServiceSpecificationEditor.tsx","webpack://jacdac-docs/./src/pages/tools/service-editor.tsx"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z\"\n}), 'Check');\nexports.default = _default;","import React, { useEffect, useState } from \"react\"\nimport {\n    Card,\n    CardContent,\n    CardActions,\n    CardHeader,\n    Typography,\n    Input,\n} from \"@mui/material\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport CheckIcon from \"@mui/icons-material/Check\"\n// tslint:disable-next-line: no-submodule-imports\nimport Alert from \"./ui/Alert\"\nimport { Button } from \"gatsby-theme-material-ui\"\nimport { NoSsr } from \"@mui/material\"\nimport { useId } from \"react\"\nimport useDeviceCatalog from \"./devices/useDeviceCatalog\"\nimport SwitchWithLabel from \"./ui/SwitchWithLabel\"\n\nexport default function RandomGenerator(props: {\n    device?: boolean\n    firmware?: boolean\n}) {\n    const { device, firmware } = props\n    const [hex, setHex] = useState(true)\n    const fieldId = useId()\n    const deviceCatalog = useDeviceCatalog()\n\n    const compute = () =>\n        device\n            ? deviceCatalog.uniqueDeviceId()\n            : firmware\n            ? deviceCatalog.uniqueFirmwareId(!hex)\n            : deviceCatalog.uniqueServiceId()\n\n    const [value, setValue] = useState(compute())\n    const [copySuccess, setCopySuccess] = useState(false)\n\n    const handleRegenerate = () => {\n        const v = compute()\n        setValue(v)\n        setCopySuccess(false)\n    }\n    const handleCopy = async () => {\n        try {\n            await navigator.clipboard.writeText(value)\n            setCopySuccess(true)\n        } catch (err) {\n            setCopySuccess(false)\n        }\n    }\n    const handleHex = (ev, checked: boolean) => {\n        setHex(checked)\n    }\n    useEffect(handleRegenerate, [hex])\n    const title = device\n        ? \"Random Device Identifier\"\n        : firmware\n        ? \"Random Product Identifier\"\n        : \"Random Service Identifier\"\n    return (\n        <NoSsr>\n            <Card>\n                <CardHeader title={title} />\n                <CardContent>\n                    {value !== undefined && (\n                        <Typography variant=\"h5\" component=\"h2\">\n                            <Input\n                                id={fieldId}\n                                value={value}\n                                readOnly={true}\n                                inputProps={{\n                                    \"aria-label\": \"generated identifier\",\n                                }}\n                            />\n                            {copySuccess && <CheckIcon />}\n                        </Typography>\n                    )}\n                    {value === undefined && (\n                        <Alert severity=\"error\">\n                            Oops, unable to generate a strong random number.\n                        </Alert>\n                    )}\n                </CardContent>\n                <CardActions>\n                    {firmware && (\n                        <SwitchWithLabel\n                            label=\"hex\"\n                            checked={hex}\n                            onChange={handleHex}\n                        />\n                    )}\n                    <Button\n                        aria-label=\"copy random number to clipboard\"\n                        size=\"small\"\n                        variant=\"contained\"\n                        onClick={handleCopy}\n                    >\n                        Copy\n                    </Button>\n                    <Button\n                        aria-label=\"regenerate random number\"\n                        size=\"small\"\n                        variant=\"contained\"\n                        color=\"primary\"\n                        onClick={handleRegenerate}\n                    >\n                        Regenerate\n                    </Button>\n                </CardActions>\n            </Card>\n        </NoSsr>\n    )\n}\n","import { useState, useMemo, useLayoutEffect } from \"react\";\n\nvar m = {\n  characterData: !0,\n  characterDataOldValue: !0,\n  childList: !0,\n  subtree: !0\n};\n\nfunction p(c) {\n  var a = window.getSelection();\n  a.empty();\n  a.addRange(c);\n}\n\nfunction q(c) {\n  return (c.metaKey || c.ctrlKey) && !c.altKey && \"KeyZ\" === c.code;\n}\n\nfunction r(c) {\n  c = [ c.firstChild ];\n  for (var b, a = \"\"; b = c.pop(); ) {\n    b.nodeType === Node.TEXT_NODE ? a += b.textContent : b.nodeType === Node.ELEMENT_NODE && \"BR\" === b.nodeName && (a += \"\\n\"), \n    b.nextSibling && c.push(b.nextSibling), b.firstChild && c.push(b.firstChild);\n  }\n  \"\\n\" !== a[a.length - 1] && (a += \"\\n\");\n  return a;\n}\n\nfunction w(c) {\n  var a = window.getSelection().getRangeAt(0), b = a.collapsed ? 0 : a.toString().length, f = document.createRange();\n  f.setStart(c, 0);\n  f.setEnd(a.startContainer, a.startOffset);\n  return {\n    position: c = (f = f.toString()).length,\n    extent: b,\n    content: f = (f = f.split(\"\\n\"))[a = f.length - 1],\n    line: a\n  };\n}\n\nfunction C(c, a, b) {\n  0 >= a && (a = 0);\n  if (!b || 0 > b) {\n    b = a;\n  }\n  var f = document.createRange();\n  c = [ c.firstChild ];\n  for (var d, l = 0, g = a; d = c[c.length - 1]; ) {\n    if (d.nodeType === Node.TEXT_NODE) {\n      if (l + d.textContent.length >= g) {\n        var h = g - l;\n        if (g === a) {\n          if (g = f, h < d.textContent.length ? g.setStart(d, h) : g.setStartAfter(d), b !== a) {\n            g = b;\n            continue;\n          } else {\n            break;\n          }\n        } else {\n          a = f;\n          h < (b = d).textContent.length ? a.setEnd(b, h) : a.setEndAfter(b);\n          break;\n        }\n      }\n      l += d.textContent.length;\n    } else if (d.nodeType === Node.ELEMENT_NODE && \"BR\" === d.nodeName) {\n      if (l + 1 >= g) {\n        if (g === a) {\n          if (h = f, 0 < d.textContent.length ? h.setStart(d, 0) : h.setStartAfter(d), b !== a) {\n            g = b;\n            continue;\n          } else {\n            break;\n          }\n        } else {\n          a = f;\n          0 < (b = d).textContent.length ? a.setEnd(b, 0) : a.setEndAfter(b);\n          break;\n        }\n      }\n      l++;\n    }\n    c.pop();\n    d.nextSibling && c.push(d.nextSibling);\n    d.firstChild && c.push(d.firstChild);\n  }\n  return f;\n}\n\nexport function useEditable(c, a, b) {\n  function f(k) {\n    var b = c.current;\n    if (b) {\n      var a = w(b);\n      b = r(b);\n      a.position += k.length - b.length;\n      e.position = a;\n      e.onChange(k, a);\n    }\n  }\n  function l(k, b) {\n    var e = c.current;\n    if (e) {\n      var a = window.getSelection().getRangeAt(0);\n      a.deleteContents();\n      a.collapse();\n      var d = b || 0;\n      (a = C(e, b = (a = w(e)).position + (0 > d ? d : 0), a.position + (0 < d ? d : 0))).deleteContents();\n      k && a.insertNode(document.createTextNode(k));\n      p(C(e, b + k.length));\n    }\n  }\n  function d(b) {\n    var a = c.current;\n    if (a) {\n      a.focus();\n      var e = 0;\n      if (\"number\" == typeof b) {\n        e = b;\n      } else {\n        var k = r(a).split(\"\\n\").slice(0, b.row);\n        b.row && (e += k.join(\"\\n\").length + 1);\n        e += b.column;\n      }\n      p(C(a, e));\n    }\n  }\n  function g() {\n    var b = c.current;\n    return {\n      text: r(b),\n      position: b = w(b)\n    };\n  }\n  function h() {\n    e.observer.disconnect();\n  }\n  b || (b = {});\n  var D = useState([])[1], e = useState((function() {\n    var e = {\n      observer: null,\n      disconnected: !1,\n      onChange: a,\n      queue: [],\n      history: [],\n      historyAt: -1,\n      position: null\n    };\n    \"undefined\" != typeof MutationObserver && (e.observer = new MutationObserver((function b(b) {\n      var a;\n      (a = e.queue).push.apply(a, b);\n    })));\n    return e;\n  }))[0], n = useMemo((function() {\n    return {\n      update: f,\n      insert: l,\n      move: d,\n      getState: g\n    };\n  }), []);\n  if (\"object\" != typeof navigator) {\n    return n;\n  }\n  useLayoutEffect((function() {\n    e.onChange = a;\n    if (c.current && !b.disabled) {\n      e.disconnected = !1;\n      e.observer.observe(c.current, m);\n      if (e.position) {\n        var k = e.position, d = k.position;\n        p(C(c.current, d, d + k.extent));\n      }\n      return h;\n    }\n  }));\n  useLayoutEffect((function() {\n    if (!c.current || b.disabled) {\n      e.history.length = 0, e.historyAt = -1;\n    } else {\n      var a = c.current;\n      if (e.position) {\n        a.focus();\n        var d = e.position, f = d.position;\n        p(C(a, f, f + d.extent));\n      }\n      var g = a.style.whiteSpace, h = a.contentEditable, l = !0;\n      try {\n        a.contentEditable = \"plaintext-only\";\n      } catch (u) {\n        a.contentEditable = \"true\", l = !1;\n      }\n      \"pre\" !== g && (a.style.whiteSpace = \"pre-wrap\");\n      b.indentation && (a.style.tabSize = a.style.MozTabSize = \"\" + b.indentation);\n      d = \"\" + \" \".repeat(b.indentation || 0);\n      var x, E = new RegExp(\"^(?:\" + d + \")\"), F = new RegExp(\"^(?:\" + d + \")*(\" + d + \")$\"), t = function(b) {\n        if (c.current && e.position) {\n          var u = r(a), d = w(a), f = (new Date).valueOf(), g = e.history[e.historyAt];\n          !b && 500 > f - x || g && g[1] === u ? x = f : (b = ++e.historyAt, e.history[b] = [ d, u ], \n          e.history.splice(b + 1), 500 < b && (e.historyAt--, e.history.shift()));\n        }\n      }, v = function() {\n        var b;\n        (b = e.queue).push.apply(b, e.observer.takeRecords());\n        b = w(a);\n        if (e.queue.length) {\n          e.observer.disconnect();\n          e.disconnected = !0;\n          var d = r(a);\n          e.position = b;\n          for (var c, f; c = e.queue.pop(); ) {\n            null !== c.oldValue && (c.target.textContent = c.oldValue);\n            for (f = c.removedNodes.length - 1; 0 <= f; f--) {\n              c.target.insertBefore(c.removedNodes[f], c.nextSibling);\n            }\n            for (f = c.addedNodes.length - 1; 0 <= f; f--) {\n              c.addedNodes[f].parentNode && c.target.removeChild(c.addedNodes[f]);\n            }\n          }\n          e.onChange(d, b);\n        }\n      }, y = function(c) {\n        if (!c.defaultPrevented && c.target === a) {\n          if (e.disconnected) {\n            return c.preventDefault(), D([]);\n          }\n          if (q(c)) {\n            c.preventDefault(), c.shiftKey ? (c = ++e.historyAt, (c = e.history[c]) || (e.historyAt = e.history.length - 1)) : (c = --e.historyAt, \n            (c = e.history[c]) || (e.historyAt = 0)), c && (e.observer.disconnect(), e.disconnected = !0, \n            e.position = c[0], e.onChange(c[1], c[0]));\n          } else {\n            t();\n            if (\"Enter\" === c.key) {\n              c.preventDefault();\n              var d = w(a), f = /\\S/g.exec(d.content);\n              d = \"\\n\" + d.content.slice(0, f ? f.index : d.content.length);\n              n.insert(d);\n            } else if ((!l || b.indentation) && \"Backspace\" === c.key) {\n              c.preventDefault(), window.getSelection().getRangeAt(0).collapsed ? (d = w(a), d = F.exec(d.content), \n              n.insert(\"\", d ? -d[1].length : -1)) : n.insert(\"\", 0);\n            } else if (b.indentation && \"Tab\" === c.key) {\n              c.preventDefault();\n              f = (d = w(a)).position - d.content.length;\n              var g = r(a);\n              d = c.shiftKey ? g.slice(0, f) + d.content.replace(E, \"\") + g.slice(f + d.content.length) : g.slice(0, f) + (b.indentation ? \" \".repeat(b.indentation) : \"\\t\") + g.slice(f);\n              n.update(d);\n            }\n            c.repeat && v();\n          }\n        }\n      }, z = function(b) {\n        b.defaultPrevented || b.isComposing || (q(b) || t(), v(), a.focus());\n      }, A = function(b) {\n        e.position = window.getSelection().rangeCount && b.target === a ? w(a) : null;\n      }, B = function(a) {\n        a.preventDefault();\n        t(!0);\n        n.insert(a.clipboardData.getData(\"text/plain\"));\n        t(!0);\n        v();\n      };\n      document.addEventListener(\"selectstart\", A);\n      window.addEventListener(\"keydown\", y);\n      a.addEventListener(\"paste\", B);\n      a.addEventListener(\"keyup\", z);\n      return function() {\n        document.removeEventListener(\"selectstart\", A);\n        window.removeEventListener(\"keydown\", y);\n        a.removeEventListener(\"paste\", B);\n        a.removeEventListener(\"keyup\", z);\n        a.style.whiteSpace = g;\n        a.contentEditable = h;\n      };\n    }\n  }), [ c.current, b.disabled, b.indentation ]);\n  return n;\n}\n//# sourceMappingURL=use-editable.es.js.map\n","/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable react/jsx-key */\nimport React, { useContext, useRef, lazy } from \"react\"\nimport Highlight, {\n    defaultProps,\n    Language,\n    PrismTheme,\n} from \"prism-react-renderer\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport LIGHT_THEME from \"prism-react-renderer/themes/vsLight\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport DARK_THEME from \"prism-react-renderer/themes/vsDark\"\nimport DarkModeContext from \"./DarkModeContext\"\nimport { useEditable } from \"use-editable\"\nimport { Alert } from \"@mui/material\"\nimport { Grid, Tooltip } from \"@mui/material\"\nimport { styled } from \"@mui/material/styles\"\nimport Suspense from \"../ui/Suspense\"\nconst GithubPullRequestButton = lazy(\n    () => import(\"../buttons/GithubPullRequestButton\")\n)\n\nconst AnnotationTooltip = styled(Tooltip)(({ theme }) => ({\n    [`& .arrow`]: {\n        color: theme.palette.error.main,\n    },\n    [`& .tooltip`]: {\n        backgroundColor: theme.palette.error.main,\n        color: theme.palette.common.white,\n        boxShadow: theme.shadows[1],\n        fontSize: theme.typography.body2.fontSize,\n    },\n}))\n\nexport default function HighlightTextField(props: {\n    language: string\n    code: string\n    minHeight?: string\n    maxHeight?: string\n    onChange: (newValue: string) => void\n    annotations?: jdspec.Diagnostic[]\n    pullRequestTitle?: string\n    pullRequestPath?: string\n    pullRequestDescription?: string\n    disabled?: boolean\n}) {\n    const {\n        code,\n        onChange,\n        language,\n        annotations,\n        pullRequestTitle,\n        pullRequestPath,\n        pullRequestDescription,\n        minHeight = \"12rem\",\n        maxHeight,\n        disabled,\n    } = props\n    const { darkMode } = useContext(DarkModeContext)\n    const theme = (darkMode === \"dark\" ? DARK_THEME : LIGHT_THEME) as PrismTheme\n    const editorRef = useRef(null)\n\n    useEditable(editorRef, onChange, {\n        disabled: !!disabled,\n        indentation: 4,\n    })\n    return (\n        <Grid container spacing={1} direction=\"row\">\n            <Grid item xs={12}>\n                <Highlight\n                    {...defaultProps}\n                    code={code}\n                    language={language as Language}\n                    theme={theme}\n                >\n                    {({ className, style, tokens, getTokenProps }) => (\n                        <pre\n                            ref={editorRef}\n                            className={className}\n                            spellCheck={false}\n                            style={{\n                                ...style,\n                                padding: \"0.5rem\",\n                                minHeight,\n                                maxHeight,\n                                whiteSpace: \"pre-wrap\",\n                                overflowWrap: \"break-word\",\n                            }}\n                        >\n                            {tokens.map((line, i) => {\n                                const annotation = annotations?.find(\n                                    a => a.line === i + 1\n                                )\n                                const title = annotation?.message\n                                const el = (\n                                    <span\n                                        key={i}\n                                        style={\n                                            annotation && {\n                                                borderBottom: \"dashed 1px red\",\n                                            }\n                                        }\n                                    >\n                                        {line\n                                            .filter(token => !token.empty)\n                                            .map((token, key) => (\n                                                <span\n                                                    {...getTokenProps({\n                                                        token,\n                                                        key,\n                                                    })}\n                                                />\n                                            ))}\n                                        {i < tokens.length - 1 ? \"\\n\" : null}\n                                    </span>\n                                )\n                                return title ? (\n                                    <AnnotationTooltip\n                                        title={title}\n                                        arrow\n                                        key={i}\n                                    >\n                                        {el}\n                                    </AnnotationTooltip>\n                                ) : (\n                                    el\n                                )\n                            })}\n                        </pre>\n                    )}\n                </Highlight>\n            </Grid>\n            {!!annotations?.length && (\n                <Grid item xs={12}>\n                    <Alert severity=\"error\">\n                        {annotations.length === 1 ? (\n                            <>\n                                line {annotations[0].line}:{\" \"}\n                                {annotations[0].message}\n                            </>\n                        ) : (\n                            <ul>\n                                {annotations.map((a, i) => (\n                                    <li key={i}>\n                                        line {a.line}: {a.message}\n                                    </li>\n                                ))}\n                            </ul>\n                        )}\n                    </Alert>\n                </Grid>\n            )}\n            {pullRequestTitle && pullRequestPath && (\n                <Grid item>\n                    <Suspense>\n                        <GithubPullRequestButton\n                            title={pullRequestTitle}\n                            head={pullRequestPath}\n                            description={pullRequestDescription}\n                            files={{\n                                [pullRequestPath + \".md\"]: code,\n                            }}\n                        />\n                    </Suspense>\n                </Grid>\n            )}\n        </Grid>\n    )\n}\n","import React, { useState } from \"react\"\nimport { Tabs, Tab } from \"@mui/material\"\nimport { serviceSpecificationFromClassIdentifier } from \"../../../jacdac-ts/src/jdom/spec\"\nimport { Paper } from \"@mui/material\"\nimport TabPanel from \"../ui/TabPanel\"\nimport Snippet from \"../ui/Snippet\"\nimport { converters } from \"../../../jacdac-ts/jacdac-spec/spectool/jdspec\"\nimport ServiceSpecification from \"./ServiceSpecification\"\n\nexport default function ServiceSpecificationSource(props: {\n    classIdentifier?: number\n    serviceSpecification?: jdspec.ServiceSpec\n    showSpecification?: boolean\n}) {\n    const { classIdentifier, serviceSpecification, showSpecification } = props\n    const [tab, setTab] = useState(0)\n    const spec =\n        serviceSpecification ||\n        serviceSpecificationFromClassIdentifier(classIdentifier)\n    const convs = converters()\n\n    const handleTabChange = (\n        event: React.ChangeEvent<unknown>,\n        newValue: number\n    ) => {\n        setTab(newValue)\n    }\n\n    let index = 0\n    return (\n        <Paper square>\n            <Tabs\n                value={tab}\n                onChange={handleTabChange}\n                aria-label=\"View specification formats\"\n            >\n                {[\n                    showSpecification && \"Specification\",\n                    \"TypeScript\",\n                    \"C\",\n                    \"JSON\",\n                ]\n                    .filter(n => !!n)\n                    .map(n => (\n                        <Tab key={n} label={n} />\n                    ))}\n            </Tabs>\n            {showSpecification && (\n                <TabPanel key=\"spec\" value={tab} index={index++}>\n                    <ServiceSpecification service={spec} />\n                </TabPanel>\n            )}\n            {[\"ts\", \"c\", \"json\"].map(lang => (\n                <TabPanel key={`conv${lang}`} value={tab} index={index++}>\n                    <Snippet\n                        copy={true}\n                        value={() => convs[lang](spec)}\n                        mode={lang}\n                        download={`service.${lang}`}\n                    />\n                </TabPanel>\n            ))}\n        </Paper>\n    )\n}\n","import React, { useEffect, useMemo } from \"react\"\nimport { Grid } from \"@mui/material\"\nimport { parseServiceSpecificationMarkdownToJSON } from \"../../../jacdac-ts/jacdac-spec/spectool/jdspec\"\nimport { serviceMap } from \"../../../jacdac-ts/src/jdom/spec\"\nimport RandomGenerator from \"../RandomGenerator\"\nimport useLocalStorage from \"../hooks/useLocalStorage\"\nimport HighlightTextField from \"../ui/HighlightTextField\"\nimport ServiceSpecificationSource from \"../specification/ServiceSpecificationSource\"\nimport { EmbedSpecsMessage } from \"../../../jacdac-ts/src/embed/protocol\"\n\nconst SERVICE_SPECIFICATION_STORAGE_KEY =\n    \"jacdac:servicespecificationeditorsource\"\n\nexport default function ServiceSpecificationEditor() {\n    const [source, setSource] = useLocalStorage(\n        SERVICE_SPECIFICATION_STORAGE_KEY,\n        \"\"\n    )\n    const json = useMemo(\n        () => parseServiceSpecificationMarkdownToJSON(source, serviceMap()),\n        [source]\n    )\n    const servicePath =\n        json &&\n        `services/${(\n            json.camelName ||\n            json.shortId ||\n            `0x${json.classIdentifier.toString(16)}`\n        ).toLowerCase()}`\n\n    useEffect(() => {\n        const services: jdspec.ServiceSpec[] =\n            json && !json.errors?.length ? [json] : []\n        window.postMessage({\n            source: \"jacdac\",\n            type: \"specs\",\n            data: {\n                services,\n            },\n        } as EmbedSpecsMessage)\n    }, [json])\n\n    return (\n        <Grid spacing={2} container>\n            <Grid item xs={12}>\n                <HighlightTextField\n                    code={source}\n                    language={\"markdown\"}\n                    onChange={setSource}\n                    annotations={json?.errors}\n                    pullRequestTitle={json && `Service: ${json.name}`}\n                    pullRequestPath={servicePath}\n                    pullRequestDescription={`This pull request defines a new service.`}\n                />\n            </Grid>\n            <Grid item xs={12}>\n                <RandomGenerator device={false} />\n            </Grid>\n            {json && (\n                <Grid item xs={12}>\n                    <ServiceSpecificationSource\n                        serviceSpecification={json}\n                        showSpecification={true}\n                    />\n                </Grid>\n            )}\n        </Grid>\n    )\n}\n","import { Link } from \"gatsby-theme-material-ui\"\nimport React from \"react\"\nimport ServiceSpecificationEditor from \"../../components/tools/ServiceSpecificationEditor\"\n\nexport const frontmatter = {\n    title: \"Service Specification Editor\",\n    description: \"Edit a service markdown specification and preview the output. Start a pull request with the service content.\",\n}\nimport CoreHead from \"../../components/shell/Head\"\nexport const Head = (props) => <CoreHead {...props} {...frontmatter} />\n\nexport default function Page() {\n    return (\n        <>\n            <h1>Service Specification Editor</h1>\n            <p>\n                Read the{\" \"}\n                <Link to=\"/reference/service-specification/\">\n                    service specification\n                </Link>{\" \"}\n                documentation. Use the packet console to monitor packets from\n                your devices.\n            </p>\n            <ServiceSpecificationEditor />\n        </>\n    )\n}\n"],"names":["useState","fieldId","useId","deviceCatalog","useDeviceCatalog","compute","device","firmware","handleRegenerate","v","setValue","setCopySuccess","handleCopy","navigator","handleHex","setHex","useEffect","title","value","copySuccess","GithubPullRequestButton","lazy","AnnotationTooltip","styled","color","theme","backgroundColor","boxShadow","fontSize","minHeight","useContext","darkMode","editorRef","useRef","useEditable","disabled","indentation","padding","whiteSpace","overflowWrap","tokens","annotation","annotations","a","i","el","borderBottom","line","token","getTokenProps","pullRequestTitle","pullRequestPath","spec","serviceSpecification","serviceSpecificationFromClassIdentifier","convs","converters","handleTabChange","setTab","index","showSpecification","n","lang","SERVICE_SPECIFICATION_STORAGE_KEY","useLocalStorage","json","useMemo","parseServiceSpecificationMarkdownToJSON","serviceMap","servicePath","services","window","source","type","data","frontmatter","description","Head","props"],"sourceRoot":""}