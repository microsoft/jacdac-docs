{"version":3,"file":"5959-b664e1359831c8c9ea27.js","mappings":"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","sources":["webpack://jacdac-docs/./src/components/dashboard/DashboardCharacterScreen.tsx"],"sourcesContent":["import React, { ChangeEvent, useEffect, useState } from \"react\"\nimport {\n    CharacterScreenReg,\n    CharacterScreenTextDirection,\n    CharacterScreenVariant,\n} from \"../../../jacdac-ts/src/jdom/constants\"\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\"\nimport { useRegisterUnpackedValue } from \"../../jacdac/useRegisterValue\"\nimport { Grid, TextField } from \"@mui/material\"\nimport useRegister from \"../hooks/useRegister\"\nimport CmdButton from \"../CmdButton\"\nimport ClearIcon from \"@mui/icons-material/Clear\"\nimport CharacterScreenWidget from \"../widgets/CharacterScreenWidget\"\nimport DashboardRegisterValueFallback from \"./DashboardRegisterValueFallback\"\n\n// https://en.wikipedia.org/wiki/Braille_ASCII\nconst BRAILE_CHARACTERS = {\n    \" \": \"⠀\", // space bar to dot-0\n    \"-\": \"⠤\",\n    \",\": \"⠠\",\n    \";\": \"⠰\",\n    \":\": \"⠱\",\n    \"!\": \"⠮\",\n    \"?\": \"⠹\",\n    \".\": \"⠨\",\n    \"(\": \"⠷\",\n    \"[\": \"⠪\",\n    \"@\": \"⠈\",\n    \"*\": \"⠡\",\n    \"/\": \"⠌\",\n    \"'\": \"⠄\",\n    '\"': \"⠐\",\n    \"\\\\\": \"⠳\",\n    \"&\": \"⠯\",\n    \"%\": \"⠩\",\n    \"^\": \"⠘\",\n    \"+\": \"⠬\",\n    \"<\": \"⠣\",\n    \">\": \"⠜\",\n    $: \"⠫\",\n    \"0\": \"⠴\",\n    \"1\": \"⠂\",\n    \"2\": \"⠆\",\n    \"3\": \"⠒\",\n    \"4\": \"⠲\",\n    \"5\": \"⠢\",\n    \"6\": \"⠖\",\n    \"7\": \"⠶\",\n    \"8\": \"⠦\",\n    \"9\": \"⠔\",\n    A: \"⠁\",\n    B: \"⠃\",\n    C: \"⠉\",\n    D: \"⠙\",\n    E: \"⠑\",\n    F: \"⠋\",\n    G: \"⠛\",\n    H: \"⠓\",\n    I: \"⠊\",\n    J: \"⠚\",\n    K: \"⠅\",\n    L: \"⠇\",\n    M: \"⠍\",\n    N: \"⠝\",\n    O: \"⠕\",\n    P: \"⠏\",\n    Q: \"⠟\",\n    R: \"⠗\",\n    S: \"⠎\",\n    T: \"⠞\",\n    U: \"⠥\",\n    V: \"⠧\",\n    W: \"⠺\",\n    X: \"⠭\",\n    Z: \"⠵\",\n    \"]\": \"⠻\",\n    \"#\": \"⠼\",\n    Y: \"⠽\",\n    \")\": \"⠾\",\n    \"=\": \"⠿\",\n    _: \"⠸\",\n}\nfunction brailify(s: string) {\n    if (!s) return s\n    let r = \"\"\n    const su = s.toLocaleUpperCase()\n    for (let i = 0; i < su.length; ++i) {\n        r += BRAILE_CHARACTERS[su.charAt(i)] || \"?\"\n    }\n    return r\n}\n\nexport default function DashboardCharacterScreen(props: DashboardServiceProps) {\n    const { service, expanded } = props\n\n    const messageRegister = useRegister(service, CharacterScreenReg.Message)\n    const rowsRegister = useRegister(service, CharacterScreenReg.Rows)\n    const columnsRegister = useRegister(service, CharacterScreenReg.Columns)\n    const textDirectionRegister = useRegister(\n        service,\n        CharacterScreenReg.TextDirection\n    )\n    const variantRegister = useRegister(service, CharacterScreenReg.Variant)\n    const brightnessRegister = useRegister(\n        service,\n        CharacterScreenReg.Brightness\n    )\n    const [message] = useRegisterUnpackedValue<[string]>(messageRegister, props)\n    const [rows] = useRegisterUnpackedValue<[number]>(rowsRegister, props)\n    const [columns] = useRegisterUnpackedValue<[number]>(columnsRegister, props)\n    const [textDirection] = useRegisterUnpackedValue<[number]>(\n        textDirectionRegister,\n        props\n    )\n    const [variant] = useRegisterUnpackedValue<[CharacterScreenVariant]>(\n        variantRegister,\n        props\n    )\n    const [brightness] = useRegisterUnpackedValue<[number]>(\n        brightnessRegister,\n        props\n    )\n\n    const [fieldMessage, setFieldMessage] = useState(message)\n\n    const handleClear = async () => {\n        setFieldMessage(\"\")\n        await messageRegister.sendSetStringAsync(\"\", true)\n    }\n    const handleFieldMessageChange = async (\n        ev: ChangeEvent<HTMLTextAreaElement>\n    ) => {\n        setFieldMessage(ev.target.value)\n        await messageRegister.sendSetStringAsync(ev.target.value, true)\n    }\n\n    // set first value of message\n    useEffect(() => {\n        if (!fieldMessage && message) setFieldMessage(message)\n    }, [message])\n\n    if (rows === undefined || columns === undefined)\n        return (\n            <DashboardRegisterValueFallback\n                register={rows === undefined ? rowsRegister : columnsRegister}\n            />\n        ) // size unknown\n\n    const converter: (s: string) => string =\n        variant === CharacterScreenVariant.Braille ? brailify : s => s\n    const cmessage = message?.split(\"\").map(converter).join(\"\")\n    const rtl = textDirection === CharacterScreenTextDirection.RightToLeft\n\n    return (\n        <Grid container spacing={1}>\n            {expanded && (\n                <Grid item xs={12}>\n                    <Grid container spacing={1}>\n                        <Grid item xs>\n                            <TextField\n                                label=\"text\"\n                                value={fieldMessage}\n                                onChange={handleFieldMessageChange}\n                                multiline={true}\n                                rows={rows || 2}\n                                fullWidth={true}\n                            />\n                        </Grid>\n                        <Grid item>\n                            <CmdButton\n                                title=\"clear the entire display\"\n                                onClick={handleClear}\n                                icon={<ClearIcon />}\n                            />\n                        </Grid>\n                    </Grid>\n                </Grid>\n            )}\n            <Grid item xs>\n                <CharacterScreenWidget\n                    rows={rows}\n                    columns={columns}\n                    rtl={rtl}\n                    message={cmessage}\n                    disabled={brightness === 0}\n                />\n            </Grid>\n        </Grid>\n    )\n}\n"],"names":["BRAILE_CHARACTERS","$","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Z","Y","_","r","su","s","i","messageRegister","useRegister","CharacterScreenReg","rowsRegister","columnsRegister","textDirectionRegister","variantRegister","brightnessRegister","useRegisterUnpackedValue","useState","handleClear","setFieldMessage","handleFieldMessageChange","ev","useEffect","rows","columns","converter","variant","CharacterScreenVariant","cmessage","message","rtl","textDirection","CharacterScreenTextDirection","expanded","brightness"],"sourceRoot":""}