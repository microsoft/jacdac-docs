{"version":3,"file":"3654-42cf31d6d817285c6046.js","mappings":"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","sources":["webpack://jacdac-docs/./node_modules/@mui/icons-material/Done.js","webpack://jacdac-docs/./node_modules/@mui/icons-material/FileCopy.js","webpack://jacdac-docs/./node_modules/@mui/icons-material/ReportProblem.js","webpack://jacdac-docs/./src/components/hooks/useMounted.ts","webpack://jacdac-docs/./src/components/ui/CopyButton.tsx"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z\"\n}), 'Done');\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4 6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z\"\n}), 'FileCopy');\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z\"\n}), 'ReportProblem');\nexports.default = _default;","import { useEffect, useRef } from \"react\"\n\nexport default function useMounted(): () => boolean {\n    const mounted = useRef(false)\n    useEffect(() => {\n        mounted.current = true\n        return () => {\n            mounted.current = false\n        }\n    }, [])\n    return () => mounted.current\n}\n","import React, { ReactNode, useState } from \"react\"\nimport FileCopyIcon from \"@mui/icons-material/FileCopy\"\nimport DoneIcon from \"@mui/icons-material/Done\"\nimport ReportProblemIcon from \"@mui/icons-material/ReportProblem\"\nimport IconButtonWithTooltip from \"./IconButtonWithTooltip\"\nimport { Button } from \"@mui/material\"\nimport useMounted from \"../hooks/useMounted\"\nimport { delay } from \"../../../jacdac-ts/src/jdom/utils\"\n\nexport default function CopyButton(props: {\n    label?: string\n    title?: string\n    onCopy?: () => Promise<string | HTMLCanvasElement>\n    text?: string\n    className?: string\n    size?: \"small\"\n    variant?: \"outlined\" | \"contained\"\n    disabled?: boolean\n    copyIcon?: ReactNode\n    color?: \"success\" | \"error\"\n}) {\n    const {\n        label,\n        text,\n        title = \"copy data to clipboard\",\n        disabled,\n        onCopy,\n        copyIcon,\n        ...rest\n    } = props\n    const [copied, setCopied] = useState<boolean>(undefined)\n    const mounted = useMounted()\n    const handleClick = async (ev: React.MouseEvent<HTMLButtonElement>) => {\n        ev.stopPropagation()\n        ev.preventDefault()\n\n        try {\n            setCopied(null)\n            const copied = text || (await onCopy?.())\n            if (typeof copied === \"string\") {\n                const c = copied as string\n                await navigator.clipboard.writeText(c)\n            } else {\n                const canvas = copied as HTMLCanvasElement\n                const blob = await new Promise<Blob>(resolve =>\n                    canvas.toBlob(blob => resolve(blob))\n                )\n                const item = new ClipboardItem({ \"image/png\": blob })\n                navigator.clipboard.write([item])\n            }\n            if (mounted()) setCopied(true)\n        } catch (e) {\n            console.debug(e)\n            if (mounted()) setCopied(false)\n        } finally {\n            await delay(2000)\n            if (mounted()) setCopied(undefined)\n        }\n    }\n    const hasCopied = copied !== undefined\n    const buttonText =\n        copied === true\n            ? \"Copied!\"\n            : copied === false\n            ? \"Copy failed\"\n            : label || title || \"copy to clipboard\"\n    return label ? (\n        <Button\n            title={title}\n            disabled={disabled || hasCopied}\n            {...rest}\n            onClick={hasCopied ? undefined : handleClick}\n        >\n            {buttonText}\n        </Button>\n    ) : (\n        <IconButtonWithTooltip\n            trackName=\"ui.copy\"\n            title={buttonText}\n            {...rest}\n            onClick={disabled ? undefined : handleClick}\n        >\n            {copied === true ? (\n                <DoneIcon color=\"success\" />\n            ) : copied === false ? (\n                <ReportProblemIcon />\n            ) : (\n                copyIcon || <FileCopyIcon />\n            )}\n        </IconButtonWithTooltip>\n    )\n}\n"],"names":["mounted","useRef","useEffect","title","rest","useState","useMounted","handleClick","ev","setCopied","copied","text","onCopy","c","navigator","canvas","blob","resolve","item","console","delay","hasCopied","buttonText","label","disabled","copyIcon"],"sourceRoot":""}